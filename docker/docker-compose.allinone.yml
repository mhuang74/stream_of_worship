services:
  allinone:
    build:
      context: ..
      dockerfile: docker/Dockerfile.allinone
    image: allinone:latest
    container_name: allinone_container
    volumes:
      # Mount current directory for scripts
      - ..:/workspace
      # Mount audio directories
      - ../poc/audio:/workspace/audio_input
      - ../poc/output_allinone:/workspace/audio_output
      # Mount cache directory to persist model downloads
      - ~/.cache:/root/.cache
    environment:
      - PYTHONUNBUFFERED=1
      - NATTEN_LOG_LEVEL=error
    working_dir: /workspace
    # Override command to keep container running
    # Use: docker compose -f docker-compose.allinone.yml run --rm allinone python your_script.py
    command: tail -f /dev/null
    stdin_open: true
    tty: true
